<!-- src/views/procesos/recibo.ejs -->
<section class="container" style="max-width: 900px">
  <h1 class="mb-3">Recibo de compra</h1>

  <% if (!pedido) { %>
    <div class="alert alert-warning">No se encontró el pedido.</div>
  <% } else { %>
    <div class="card mb-3">
      <div class="card-body">
        <p class="mb-1"><strong>Folio:</strong> <%= pedido.id %></p>
        <% 
          const _d = new Date(pedido.fecha || pedido.created_at || pedido.creado_en || Date.now());
          const _local = new Date(_d.getTime() - _d.getTimezoneOffset() * 60000)
                            .toISOString().slice(0,19).replace('T',' ');
        %>
        <p class="mb-1"><strong>Fecha:</strong> <%= _local %></p>
        <p class="mb-1"><strong>Usuario ID:</strong> <%= pedido.usuario_id %></p>
      </div>
    </div>

    <div class="table-responsive mb-3">
      <table class="table">
        <thead>
          <tr>
            <th>Concepto</th>
            <th class="text-end">Monto</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Subtotal</td>
            <td class="text-end">Q <%= Number(pedido.subtotal).toFixed(2) %></td>
          </tr>
          <tr>
            <td>IVA</td>
            <td class="text-end">Q</Q> <%= Number(pedido.iva).toFixed(2) %></td>
          </tr>
          <tr>
            <td>Envío</td>
            <td class="text-end">Q <%= Number(pedido.envio).toFixed(2) %></td>
          </tr>
          <tr>
            <th>Total</th>
            <th class="text-end">Q <%= Number(pedido.total).toFixed(2) %></th>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="d-flex gap-2">
      <a href="/procesos/reporte" class="btn btn-primary">Ver reporte</a>
      <a href="/productos" class="btn btn-outline-secondary">Seguir comprando</a>
    </div>
  <% } %>
</section>
