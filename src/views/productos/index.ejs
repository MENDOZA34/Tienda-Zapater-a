<h1 class="mb-3">Productos</h1>

<form class="row g-2 mb-3">
  <div class="col-md-4"><input class="form-control" name="q" value="<%= q||'' %>" placeholder="Buscar..."></div>
  <div class="col-md-4">
    <select class="form-select" name="cat">
      <option value="">Todas las categorías</option>
      <% (categorias||[]).forEach(c=> { %>
        <option value="<%= c.id %>" <%= String(cat||'')===String(c.id)?'selected':'' %>><%= c.nombre %></option>
      <% }) %>
    </select>
  </div>
  <div class="col-md-4"><button class="btn btn-outline-primary w-100">Filtrar</button></div>
</form>

<% if (!productos || !productos.length) { %>
  <p>No hay productos aún.</p>
<% } else { %>
  <div class="row g-3">
    <% productos.forEach(p => { %>
      <div class="col-12 col-md-4">
        <div class="card h-100 shadow-sm product-card">
          <img src="<%= p.imagen_url || '/img/placeholder.webp' %>" class="card-img-top" alt="<%= p.titulo %>" loading="lazy">
          <div class="card-body d-flex flex-column">
            <h5 class="card-title"><%= p.titulo %></h5>
            <p class="text-muted mb-2"><%= p.categoria || '' %></p>
            <div class="mt-auto d-flex justify-content-between align-items-center">
              <span class="fw-bold">Q<%= Number(p.precio).toFixed(2) %></span>
              <a class="btn btn-sm btn-outline-secondary" href="/productos/<%= p.id %>">Ver</a>
            </div>
          </div>
        </div>
      </div>
    <% }) %>
  </div>
<% } %>
